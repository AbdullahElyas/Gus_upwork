<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Biomechanical Assessment Report</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 27px; /* reduced from 40px */
            line-height: 1.4; /* reduced from 1.6 */
            font-size: 11px; /* reduced base font size */
        }
        
        h1, h2, h3 {
            color: #2C3E50;
        }
        
        h1 {
            text-align: center;
            border-bottom: 2px solid #2C3E50; /* reduced from 3px */
            padding-bottom: 7px; /* reduced from 10px */
            font-size: 1.8em; /* reduced from default */
        }
        
        h2 {
            font-size: 1.4em; /* explicitly set reduced size */
        }
        
        h3 {
            font-size: 1.2em; /* explicitly set reduced size */
        }
        
        .assessment-section {
            margin-bottom: 33px; /* reduced from 50px */
            page-break-inside: avoid;
        }
        
        .data-tables {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 20px; /* reduced from 30px */
            margin-bottom: 27px; /* reduced from 40px */
        }
        
        .table-container {
            width: 100%;
            max-width: 1000px;
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        
        .table-container h3 {
            text-align: center;
            margin-bottom: 13px; /* reduced from 20px */
            width: 100%;
        }
        
        .section-title {
            text-align: center;
            font-size: 1.0em; /* reduced from 1.5em */
            color: #2C3E50;
            margin: 27px 0 13px 0; /* reduced from 40px 0 20px 0 */
            padding: 7px; /* reduced from 10px */
            background: #f8f9fa;
            border-radius: 5px; /* reduced from 8px */
        }
        
        table {
            width: 100%;
            max-width: 900px;
            border-collapse: collapse;
            margin-bottom: 13px; /* reduced from 20px */
            box-shadow: 0 1px 3px rgba(0,0,0,0.1); /* reduced shadow */
        }
        
        th, td {
            border: 1px solid #34495E;
            padding: 5px; /* reduced from 8px */
            text-align: center;
            font-size: 8px; /* reduced from 12px */
        }
        
        th {
            background-color: #34495E;
            color: white;
            font-weight: bold;
        }
        
        .range-header {
            background-color: #3498DB;
        }
        
        .force-header {
            background-color: #E74C3C;
        }
        
        .weak {
            background-color: #F8D7DA; /* light red */
        }
        
        .moderate {
            background-color: #FFF3CD; /* light yellow */
        }
        
        .strong {
            background-color: #D4EDDA; /* light green */
        }
        
        .unavailable {
            background-color: #E9ECEF; /* light gray */
            font-style: italic;
            color: #6C757D;
        }
        
        .gold-standard {
            background-color: #FFF9C4; /* light gold */
            font-weight: bold;
        }
        
        .asymmetry-low {
            background-color: #D4EDDA; /* light green */
        }
        
        .asymmetry-moderate {
            background-color: #FFF3CD; /* light yellow */
        }
        
        .asymmetry-high {
            background-color: #F8D7DA; /* light red */
        }
        
        .graph-text {
            display: flex;
            align-items: flex-start;
            margin-bottom: 27px; /* reduced from 40px */
            gap: 13px; /* reduced from 20px */
        }
        
        .graph-text.text-left {
            flex-direction: row;
        }
        
        .graph-text.text-right {
            flex-direction: row-reverse;
        }
        
        .graph-text img {
            width: 200px; /* reduced from 300px */
            height: 200px; /* reduced from 300px */
            object-fit: contain;
            border: 1px solid #ccc;
            padding: 7px; /* reduced from 10px */
            background: white;
            border-radius: 5px; /* reduced from 8px */
            box-shadow: 0 1px 7px rgba(0,0,0,0.1); /* reduced shadow */
        }
        
        .text-content {
            flex: 1;
            padding: 13px; /* reduced from 20px */
            background: #e8f4f8; /* changed from #f8f9fa to match posture section */
            border-radius: 5px; /* reduced from 8px */
            border-left: 3px solid #2C3E50; /* reduced from 4px */
            font-size: 10px; /* explicitly set smaller text */
            line-height: 1.4; /* improved readability */
        }
        
        .posture-section {
            background: #e8f4f8;
            padding: 13px; /* reduced from 20px */
            border-radius: 5px; /* reduced from 8px */
            margin-bottom: 20px; /* reduced from 30px */
            border-left: 3px solid #3498DB; /* reduced from 4px */
            font-size: 10px; /* explicitly set smaller text */
            line-height: 1.4;
        }
        
        .note {
            font-style: italic;
            color: #555;
            background: #f0f0f0;
            padding: 10px; /* reduced from 15px */
            border-radius: 3px; /* reduced from 5px */
            margin-top: 13px; /* reduced from 20px */
            font-size: 9px; /* smaller note text */
        }
        
        .section-divider {
            height: 1px; /* reduced from 2px */
            background: linear-gradient(to right, #2C3E50, transparent);
            margin: 27px 0; /* reduced from 40px 0 */
        }
        
        .value-good { color: #27AE60; font-weight: bold; }
        .value-moderate { color: #F39C12; font-weight: bold; }
        .value-poor { color: #E74C3C; font-weight: bold; }
    </style>
</head>
<body>

<h1>Biomechanical Assessment Report</h1>

<!-- Data Tables Section -->
<div class="assessment-section">
    <h2>Assessment Data Overview</h2>
    
    <!-- Range of Motion Section -->
    <div class="section-title">Range of Motion Assessment</div>
    
    <div class="data-tables">
        {% if ankle_data %}
        <div class="table-container">
            <h3>Ankle/Foot Range of Motion</h3>
            <table>
                <tr class="range-header">
                    <th>Movement</th>
                    <th>Left</th>
                    <th>Right</th>
                    <th>Gold Standard</th>
                    <th>Left %</th>
                    <th>Right %</th>
                    <th>Asymmetry %</th>
                </tr>
                <tr>
                    <td>Dorsiflexion Range</td>
                    <td class="{% if ankle_data.dorsiflexion_range_left == 'unavailable data' %}unavailable{% endif %}">
                        {{ ankle_data.dorsiflexion_range_left }}°
                    </td>
                    <td class="{% if ankle_data.dorsiflexion_range_right == 'unavailable data' %}unavailable{% endif %}">
                        {{ ankle_data.dorsiflexion_range_right }}°
                    </td>
                    <td class="gold-standard">30°</td>
                    <td>{{ ankle_data.dorsiflexion_left_percent }}%</td>
                    <td>{{ ankle_data.dorsiflexion_right_percent }}%</td>
                    <td class="asymmetry-moderate">{{ ankle_data.dorsiflexion_asymmetry }}%</td>
                </tr>
                <tr>
                    <td>Plantarflexion Range</td>
                    <td class="{% if ankle_data.plantarflexion_range_left == 'unavailable data' %}unavailable{% endif %}">
                        {{ ankle_data.plantarflexion_range_left }}°
                    </td>
                    <td class="{% if ankle_data.plantarflexion_range_right == 'unavailable data' %}unavailable{% endif %}">
                        {{ ankle_data.plantarflexion_range_right }}°
                    </td>
                    <td class="gold-standard">165°</td>
                    <td>{{ ankle_data.plantarflexion_left_percent }}%</td>
                    <td>{{ ankle_data.plantarflexion_right_percent }}%</td>
                    <td class="asymmetry-low">{{ ankle_data.plantarflexion_asymmetry }}%</td>
                </tr>
            </table>
        </div>
        {% endif %}
        
        {% if knee_data %}
        <div class="table-container">
            <h3>Knee Range of Motion</h3>
            <table>
                <tr class="range-header">
                    <th>Movement</th>
                    <th>Left</th>
                    <th>Right</th>
                    <th>Gold Standard</th>
                    <th>Left %</th>
                    <th>Right %</th>
                    <th>Asymmetry %</th>
                </tr>
                <tr>
                    <td>Flexion Range</td>
                    <td class="{% if knee_data.flexion_range_left == 'unavailable data' %}unavailable{% endif %}">
                        {{ knee_data.flexion_range_left }}°
                    </td>
                    <td class="{% if knee_data.flexion_range_right == 'unavailable data' %}unavailable{% endif %}">
                        {{ knee_data.flexion_range_right }}°
                    </td>
                    <td class="gold-standard">160°</td>
                    <td>{{ knee_data.flexion_left_percent }}%</td>
                    <td>{{ knee_data.flexion_right_percent }}%</td>
                    <td class="asymmetry-low">{{ knee_data.flexion_asymmetry }}%</td>
                </tr>
                <tr>
                    <td>Extension Range</td>
                    <td class="{% if knee_data.extension_range_left == 'unavailable data' %}unavailable{% endif %}">
                        {{ knee_data.extension_range_left }}°
                    </td>
                    <td class="{% if knee_data.extension_range_right == 'unavailable data' %}unavailable{% endif %}">
                        {{ knee_data.extension_range_right }}°
                    </td>
                    <td class="gold-standard">170°</td>
                    <td>{{ knee_data.extension_left_percent }}%</td>
                    <td>{{ knee_data.extension_right_percent }}%</td>
                    <td class="asymmetry-moderate">{{ knee_data.extension_asymmetry }}%</td>
                </tr>
            </table>
        </div>
        {% endif %}
        
        {% if hip_data %}
        <div class="table-container">
            <h3>Hip Range of Motion</h3>
            <table>
                <tr class="range-header">
                    <th>Movement</th>
                    <th>Left</th>
                    <th>Right</th>
                    <th>Gold Standard</th>
                    <th>Left %</th>
                    <th>Right %</th>
                    <th>Asymmetry %</th>
                </tr>
                <tr>
                    <td>Flexion Range</td>
                    <td class="{% if hip_data.flexion_range_left == 'unavailable data' %}unavailable{% endif %}">
                        {{ hip_data.flexion_range_left }}°
                    </td>
                    <td class="{% if hip_data.flexion_range_right == 'unavailable data' %}unavailable{% endif %}">
                        {{ hip_data.flexion_range_right }}°
                    </td>
                    <td class="gold-standard">90°</td>
                    <td>{{ hip_data.flexion_left_percent }}%</td>
                    <td>{{ hip_data.flexion_right_percent }}%</td>
                    <td class="asymmetry-low">{{ hip_data.flexion_asymmetry }}%</td>
                </tr>
                <tr>
                    <td>Extension Range</td>
                    <td class="{% if hip_data.extension_range_left == 'unavailable data' %}unavailable{% endif %}">
                        {{ hip_data.extension_range_left }}°
                    </td>
                    <td class="{% if hip_data.extension_range_right == 'unavailable data' %}unavailable{% endif %}">
                        {{ hip_data.extension_range_right }}°
                    </td>
                    <td class="gold-standard">30°</td>
                    <td>{{ hip_data.extension_left_percent }}%</td>
                    <td>{{ hip_data.extension_right_percent }}%</td>
                    <td class="asymmetry-moderate">{{ hip_data.extension_asymmetry }}%</td>
                </tr>
                <tr>
                    <td>Abduction Range</td>
                    <td class="{% if hip_data.abduction_range_left == 'unavailable data' %}unavailable{% endif %}">
                        {{ hip_data.abduction_range_left }}°
                    </td>
                    <td class="{% if hip_data.abduction_range_right == 'unavailable data' %}unavailable{% endif %}">
                        {{ hip_data.abduction_range_right }}°
                    </td>
                    <td class="gold-standard">55°</td>
                    <td>{{ hip_data.abduction_left_percent }}%</td>
                    <td>{{ hip_data.abduction_right_percent }}%</td>
                    <td class="asymmetry-high">{{ hip_data.abduction_asymmetry }}%</td>
                </tr>
                <tr>
                    <td>Adduction Range</td>
                    <td class="{% if hip_data.adduction_range_left == 'unavailable data' %}unavailable{% endif %}">
                        {{ hip_data.adduction_range_left }}°
                    </td>
                    <td class="{% if hip_data.adduction_range_right == 'unavailable data' %}unavailable{% endif %}">
                        {{ hip_data.adduction_range_right }}°
                    </td>
                    <td class="gold-standard">35°</td>
                    <td>{{ hip_data.adduction_left_percent }}%</td>
                    <td>{{ hip_data.adduction_right_percent }}%</td>
                    <td class="asymmetry-low">{{ hip_data.adduction_asymmetry }}%</td>
                </tr>
                <tr>
                    <td>Ext Rotation Range</td>
                    <td class="{% if hip_data.ext_rotation_range_left == 'unavailable data' %}unavailable{% endif %}">
                        {{ hip_data.ext_rotation_range_left }}°
                    </td>
                    <td class="{% if hip_data.ext_rotation_range_right == 'unavailable data' %}unavailable{% endif %}">
                        {{ hip_data.ext_rotation_range_right }}°
                    </td>
                    <td class="gold-standard">45°</td>
                    <td>{{ hip_data.ext_rotation_left_percent }}%</td>
                    <td>{{ hip_data.ext_rotation_right_percent }}%</td>
                    <td class="asymmetry-moderate">{{ hip_data.ext_rotation_asymmetry }}%</td>
                </tr>
                <tr>
                    <td>Int Rotation Range</td>
                    <td class="{% if hip_data.int_rotation_range_left == 'unavailable data' %}unavailable{% endif %}">
                        {{ hip_data.int_rotation_range_left }}°
                    </td>
                    <td class="{% if hip_data.int_rotation_range_right == 'unavailable data' %}unavailable{% endif %}">
                        {{ hip_data.int_rotation_range_right }}°
                    </td>
                    <td class="gold-standard">40°</td>
                    <td>{{ hip_data.int_rotation_left_percent }}%</td>
                    <td>{{ hip_data.int_rotation_right_percent }}%</td>
                    <td class="asymmetry-low">{{ hip_data.int_rotation_asymmetry }}%</td>
                </tr>
            </table>
        </div>
        {% endif %}
        
        {% if shoulder_data %}
        <div class="table-container">
            <h3>Shoulder Range of Motion</h3>
            <table>
                <tr class="range-header">
                    <th>Movement</th>
                    <th>Left</th>
                    <th>Right</th>
                    <th>Gold Standard</th>
                    <th>Left %</th>
                    <th>Right %</th>
                    <th>Asymmetry %</th>
                </tr>
                <tr>
                    <td>Ext Rotation Range</td>
                    <td class="{% if shoulder_data.ext_rotation_range_left == 'unavailable data' %}unavailable{% endif %}">
                        {{ shoulder_data.ext_rotation_range_left }}°
                    </td>
                    <td class="{% if shoulder_data.ext_rotation_range_right == 'unavailable data' %}unavailable{% endif %}">
                        {{ shoulder_data.ext_rotation_range_right }}°
                    </td>
                    <td class="gold-standard">90°</td>
                    <td>{{ shoulder_data.ext_rotation_left_percent }}%</td>
                    <td>{{ shoulder_data.ext_rotation_right_percent }}%</td>
                    <td class="asymmetry-moderate">{{ shoulder_data.ext_rotation_asymmetry }}%</td>
                </tr>
                <tr>
                    <td>Int Rotation Range</td>
                    <td class="{% if shoulder_data.int_rotation_range_left == 'unavailable data' %}unavailable{% endif %}">
                        {{ shoulder_data.int_rotation_range_left }}°
                    </td>
                    <td class="{% if shoulder_data.int_rotation_range_right == 'unavailable data' %}unavailable{% endif %}">
                        {{ shoulder_data.int_rotation_range_right }}°
                    </td>
                    <td class="gold-standard">70°</td>
                    <td>{{ shoulder_data.int_rotation_left_percent }}%</td>
                    <td>{{ shoulder_data.int_rotation_right_percent }}%</td>
                    <td class="asymmetry-high">{{ shoulder_data.int_rotation_asymmetry }}%</td>
                </tr>
                <tr>
                    <td>Flexion Range</td>
                    <td class="{% if shoulder_data.flexion_range_left == 'unavailable data' %}unavailable{% endif %}">
                        {{ shoulder_data.flexion_range_left }}°
                    </td>
                    <td class="{% if shoulder_data.flexion_range_right == 'unavailable data' %}unavailable{% endif %}">
                        {{ shoulder_data.flexion_range_right }}°
                    </td>
                    <td class="gold-standard">180°</td>
                    <td>{{ shoulder_data.flexion_left_percent }}%</td>
                    <td>{{ shoulder_data.flexion_right_percent }}%</td>
                    <td class="asymmetry-low">{{ shoulder_data.flexion_asymmetry }}%</td>
                </tr>
                <tr>
                    <td>Extension Range</td>
                    <td class="{% if shoulder_data.extension_range_left == 'unavailable data' %}unavailable{% endif %}">
                        {{ shoulder_data.extension_range_left }}°
                    </td>
                    <td class="{% if shoulder_data.extension_range_right == 'unavailable data' %}unavailable{% endif %}">
                        {{ shoulder_data.extension_range_right }}°
                    </td>
                    <td class="gold-standard">60°</td>
                    <td>{{ shoulder_data.extension_left_percent }}%</td>
                    <td>{{ shoulder_data.extension_right_percent }}%</td>
                    <td class="asymmetry-moderate">{{ shoulder_data.extension_asymmetry }}%</td>
                </tr>
            </table>
        </div>
        {% endif %}
    </div>

    <!-- Force Production Section -->
    <div class="section-title">Force Production Assessment</div>
    
    <div class="data-tables">
        {% if ankle_data %}
        <div class="table-container">
            <h3>Ankle/Foot Force Production</h3>
            <table>
                <tr class="force-header">
                    <th>Movement</th>
                    <th>Left</th>
                    <th>Right</th>
                    <th>Left %</th>
                    <th>Right %</th>
                    <th>Asymmetry %</th>
                </tr>
                <tr>
                    <td>Dorsiflexion Force</td>
                    <td class="{% if ankle_data.dorsiflexion_force_left == 'unavailable data' %}unavailable{% endif %}">
                        {{ ankle_data.dorsiflexion_force_left }}
                    </td>
                    <td class="{% if ankle_data.dorsiflexion_force_right == 'unavailable data' %}unavailable{% endif %}">
                        {{ ankle_data.dorsiflexion_force_right }}
                    </td>
                    <td>{{ ankle_data.dorsiflexion_force_left_percent }}%</td>
                    <td>{{ ankle_data.dorsiflexion_force_right_percent }}%</td>
                    <td class="asymmetry-low">{{ ankle_data.dorsiflexion_force_asymmetry }}%</td>
                </tr>
                <tr>
                    <td>Plantarflexion Force</td>
                    <td class="{% if ankle_data.plantarflexion_force_left == 'unavailable data' %}unavailable{% endif %}">
                        {{ ankle_data.plantarflexion_force_left }}
                    </td>
                    <td class="{% if ankle_data.plantarflexion_force_right == 'unavailable data' %}unavailable{% endif %}">
                        {{ ankle_data.plantarflexion_force_right }}
                    </td>
                    <td>{{ ankle_data.plantarflexion_force_left_percent }}%</td>
                    <td>{{ ankle_data.plantarflexion_force_right_percent }}%</td>
                    <td class="asymmetry-moderate">{{ ankle_data.plantarflexion_force_asymmetry }}%</td>
                </tr>
            </table>
        </div>
        {% endif %}
        
        {% if knee_data %}
        <div class="table-container">
            <h3>Knee Force Production</h3>
            <table>
                <tr class="force-header">
                    <th>Movement</th>
                    <th>Left</th>
                    <th>Right</th>
                    <th>Left %</th>
                    <th>Right %</th>
                    <th>Asymmetry %</th>
                </tr>
                <tr>
                    <td>Flexion Force</td>
                    <td class="{% if knee_data.flexion_force_left == 'unavailable data' %}unavailable{% endif %}">
                        {{ knee_data.flexion_force_left }}
                    </td>
                    <td class="{% if knee_data.flexion_force_right == 'unavailable data' %}unavailable{% endif %}">
                        {{ knee_data.flexion_force_right }}
                    </td>
                    <td>{{ knee_data.flexion_force_left_percent }}%</td>
                    <td>{{ knee_data.flexion_force_right_percent }}%</td>
                    <td class="asymmetry-moderate">{{ knee_data.flexion_force_asymmetry }}%</td>
                </tr>
                <tr>
                    <td>Extension Force</td>
                    <td class="{% if knee_data.extension_force_left == 'unavailable data' %}unavailable{% endif %}">
                        {{ knee_data.extension_force_left }}
                    </td>
                    <td class="{% if knee_data.extension_force_right == 'unavailable data' %}unavailable{% endif %}">
                        {{ knee_data.extension_force_right }}
                    </td>
                    <td>{{ knee_data.extension_force_left_percent }}%</td>
                    <td>{{ knee_data.extension_force_right_percent }}%</td>
                    <td class="asymmetry-high">{{ knee_data.extension_force_asymmetry }}%</td>
                </tr>
                <tr>
                    <td>Hamstring/Quad Ratio</td>
                    <td class="{% if knee_data.hamstring_quad_ratio_left == 'unavailable data' %}unavailable{% endif %}">
                        {{ knee_data.hamstring_quad_ratio_left }}
                    </td>
                    <td class="{% if knee_data.hamstring_quad_ratio_right == 'unavailable data' %}unavailable{% endif %}">
                        {{ knee_data.hamstring_quad_ratio_right }}
                    </td>
                    <td>{{ knee_data.hq_ratio_left_percent }}%</td>
                    <td>{{ knee_data.hq_ratio_right_percent }}%</td>
                    <td class="asymmetry-low">{{ knee_data.hq_ratio_asymmetry }}%</td>
                </tr>
            </table>
        </div>
        {% endif %}
        
        {% if hip_data %}
        <div class="table-container">
            <h3>Hip Force Production</h3>
            <table>
                <tr class="force-header">
                    <th>Movement</th>
                    <th>Left</th>
                    <th>Right</th>
                    <th>Left %</th>
                    <th>Right %</th>
                    <th>Asymmetry %</th>
                </tr>
                <tr>
                    <td>Flexion Force</td>
                    <td class="{% if hip_data.flexion_force_left == 'unavailable data' %}unavailable{% endif %}">
                        {{ hip_data.flexion_force_left }}
                    </td>
                    <td class="{% if hip_data.flexion_force_right == 'unavailable data' %}unavailable{% endif %}">
                        {{ hip_data.flexion_force_right }}
                    </td>
                    <td>{{ hip_data.flexion_force_left_percent }}%</td>
                    <td>{{ hip_data.flexion_force_right_percent }}%</td>
                    <td class="asymmetry-low">{{ hip_data.flexion_force_asymmetry }}%</td>
                </tr>
                <tr>
                    <td>Extension Force</td>
                    <td class="{% if hip_data.extension_force_left == 'unavailable data' %}unavailable{% endif %}">
                        {{ hip_data.extension_force_left }}
                    </td>
                    <td class="{% if hip_data.extension_force_right == 'unavailable data' %}unavailable{% endif %}">
                        {{ hip_data.extension_force_right }}
                    </td>
                    <td>{{ hip_data.extension_force_left_percent }}%</td>
                    <td>{{ hip_data.extension_force_right_percent }}%</td>
                    <td class="asymmetry-moderate">{{ hip_data.extension_force_asymmetry }}%</td>
                </tr>
                <tr>
                    <td>Abduction Force</td>
                    <td class="{% if hip_data.abduction_force_left == 'unavailable data' %}unavailable{% endif %}">
                        {{ hip_data.abduction_force_left }}
                    </td>
                    <td class="{% if hip_data.abduction_force_right == 'unavailable data' %}unavailable{% endif %}">
                        {{ hip_data.abduction_force_right }}
                    </td>
                    <td>{{ hip_data.abduction_force_left_percent }}%</td>
                    <td>{{ hip_data.abduction_force_right_percent }}%</td>
                    <td class="asymmetry-high">{{ hip_data.abduction_force_asymmetry }}%</td>
                </tr>
                <tr>
                    <td>Adduction Force</td>
                    <td class="{% if hip_data.adduction_force_left == 'unavailable data' %}unavailable{% endif %}">
                        {{ hip_data.adduction_force_left }}
                    </td>
                    <td class="{% if hip_data.adduction_force_right == 'unavailable data' %}unavailable{% endif %}"></td>
                        {{ hip_data.adduction_force_right }}
                    </td>
                    <td>{{ hip_data.adduction_force_left_percent }}%</td>
                    <td>{{ hip_data.adduction_force_right_percent }}%</td>
                    <td class="asymmetry-low">{{ hip_data.adduction_force_asymmetry }}%</td>
                </tr>
                <tr>
                    <td>Ext Rotation Force</td>
                    <td class="{% if hip_data.ext_rotation_force_left == 'unavailable data' %}unavailable{% endif %}">
                        {{ hip_data.ext_rotation_force_left }}
                    </td>
                    <td class="{% if hip_data.ext_rotation_force_right == 'unavailable data' %}unavailable{% endif %}">
                        {{ hip_data.ext_rotation_force_right }}
                    </td>
                    <td>{{ hip_data.ext_rotation_force_left_percent }}%</td>
                    <td>{{ hip_data.ext_rotation_force_right_percent }}%</td>
                    <td class="asymmetry-moderate">{{ hip_data.ext_rotation_force_asymmetry }}%</td>
                </tr>
                <tr>
                    <td>Int Rotation Force</td>
                    <td class="{% if hip_data.int_rotation_force_left == 'unavailable data' %}unavailable{% endif %}">
                        {{ hip_data.int_rotation_force_left }}
                    </td>
                    <td class="{% if hip_data.int_rotation_force_right == 'unavailable data' %}unavailable{% endif %}">
                        {{ hip_data.int_rotation_force_right }}
                    </td>
                    <td>{{ hip_data.int_rotation_force_left_percent }}%</td>
                    <td>{{ hip_data.int_rotation_force_right_percent }}%</td>
                    <td class="asymmetry-low">{{ hip_data.int_rotation_force_asymmetry }}%</td>
                </tr>
            </table>
        </div>
        {% endif %}
        
        {% if shoulder_data %}
        <div class="table-container">
            <h3>Shoulder Force Production</h3>
            <table>
                <tr class="force-header">
                    <th>Movement</th>
                    <th>Left</th>
                    <th>Right</th>
                    <th>Left %</th>
                    <th>Right %</th>
                    <th>Asymmetry %</th>
                </tr>
                <tr>
                    <td>Ext Rotation Force</td>
                    <td class="{% if shoulder_data.ext_rotation_force_left == 'unavailable data' %}unavailable{% endif %}">
                        {{ shoulder_data.ext_rotation_force_left }}
                    </td>
                    <td class="{% if shoulder_data.ext_rotation_force_right == 'unavailable data' %}unavailable{% endif %}">
                        {{ shoulder_data.ext_rotation_force_right }}
                    </td>
                    <td>{{ shoulder_data.ext_rotation_force_left_percent }}%</td>
                    <td>{{ shoulder_data.ext_rotation_force_right_percent }}%</td>
                    <td class="asymmetry-moderate">{{ shoulder_data.ext_rotation_force_asymmetry }}%</td>
                </tr>
                <tr>
                    <td>Int Rotation Force</td>
                    <td class="{% if shoulder_data.int_rotation_force_left == 'unavailable data' %}unavailable{% endif %}">
                        {{ shoulder_data.int_rotation_force_left }}
                    </td>
                    <td class="{% if shoulder_data.int_rotation_force_right == 'unavailable data' %}unavailable{% endif %}"></td>
                        {{ shoulder_data.int_rotation_force_right }}
                    </td>
                    <td>{{ shoulder_data.int_rotation_force_left_percent }}%</td>
                    <td>{{ shoulder_data.int_rotation_force_right_percent }}%</td>
                    <td class="asymmetry-high">{{ shoulder_data.int_rotation_force_asymmetry }}%</td>
                </tr>
                <tr>
                    <td>Flexion Force</td>
                    <td class="{% if shoulder_data.flexion_force_left == 'unavailable data' %}unavailable{% endif %}">
                        {{ shoulder_data.flexion_force_left }}
                    </td>
                    <td class="{% if shoulder_data.flexion_force_right == 'unavailable data' %}unavailable{% endif %}">
                        {{ shoulder_data.flexion_force_right }}
                    </td>
                    <td>{{ shoulder_data.flexion_force_left_percent }}%</td>
                    <td>{{ shoulder_data.flexion_force_right_percent }}%</td>
                    <td class="asymmetry-low">{{ shoulder_data.flexion_force_asymmetry }}%</td>
                </tr>
                <tr>
                    <td>I ISO</td>
                    <td class="{% if shoulder_data.i_iso_left == 'unavailable data' %}unavailable{% endif %}">
                        {{ shoulder_data.i_iso_left }}
                    </td>
                    <td class="{% if shoulder_data.i_iso_right == 'unavailable data' %}unavailable{% endif %}">
                        {{ shoulder_data.i_iso_right }}
                    </td>
                    <td>{{ shoulder_data.i_iso_left_percent }}%</td>
                    <td>{{ shoulder_data.i_iso_right_percent }}%</td>
                    <td class="asymmetry-moderate">{{ shoulder_data.i_iso_asymmetry }}%</td>
                </tr>
                <tr>
                    <td>Y ISO</td>
                    <td class="{% if shoulder_data.y_iso_left == 'unavailable data' %}unavailable{% endif %}">
                        {{ shoulder_data.y_iso_left }}
                    </td>
                    <td class="{% if shoulder_data.y_iso_right == 'unavailable data' %}unavailable{% endif %}">
                        {{ shoulder_data.y_iso_right }}
                    </td>
                    <td>{{ shoulder_data.y_iso_left_percent }}%</td>
                    <td>{{ shoulder_data.y_iso_right_percent }}%</td>
                    <td class="asymmetry-high">{{ shoulder_data.y_iso_asymmetry }}%</td>
                </tr>
                <tr>
                    <td>T ISO</td>
                    <td class="{% if shoulder_data.t_iso_left == 'unavailable data' %}unavailable{% endif %}">
                        {{ shoulder_data.t_iso_left }}
                    </td>
                    <td class="{% if shoulder_data.t_iso_right == 'unavailable data' %}unavailable{% endif %}">
                        {{ shoulder_data.t_iso_right }}
                    </td>
                    <td>{{ shoulder_data.t_iso_left_percent }}%</td>
                    <td>{{ shoulder_data.t_iso_right_percent }}%</td>
                    <td class="asymmetry-low">{{ shoulder_data.t_iso_asymmetry }}%</td>
                </tr>
            </table>
        </div>
        {% endif %}
        
        {% if thoracic_data %}
        <div class="table-container">
            <h3>Ribcage/Thoracic Assessment</h3>
            <table>
                <tr class="range-header">
                    <th>Measurement</th>
                    <th>Value</th>
                    <th>Gold Standard</th>
                    <th>Percentage</th>
                    <th>Status</th>
                </tr>
                <tr>
                    <td>Thoracic Curvature</td>
                    <td>{{ thoracic_data.thoracic_curvature }}°</td>
                    <td class="gold-standard">30-35°</td>
                    <td>{{ thoracic_data.thoracic_percentage }}%</td>
                    <td class="{% if thoracic_data.thoracic_curvature > 35 %}value-poor{% elif thoracic_data.thoracic_curvature < 30 %}value-poor{% else %}value-good{% endif %}"></td>
                        {% if thoracic_data.thoracic_curvature > 35 %}Increased{% elif thoracic_data.thoracic_curvature < 30 %}Reduced{% else %}Normal{% endif %}
                    </td>
                </tr>
                <tr>
                    <td>Lumbar Curvature</td>
                    <td>{{ thoracic_data.lumbar_curvature }}°</td>
                    <td class="gold-standard">30-35°</td>
                    <td>{{ thoracic_data.lumbar_percentage }}%</td>
                    <td class="{% if thoracic_data.lumbar_curvature < 30 %}value-poor{% elif thoracic_data.lumbar_curvature > 35 %}value-poor{% else %}value-good{% endif %}"></td>
                        {% if thoracic_data.lumbar_curvature < 30 %}Reduced{% elif thoracic_data.lumbar_curvature > 35 %}Increased{% else %}Normal{% endif %}
                    </td>
                </tr>
                <tr>
                    <td>Forward Head Posture</td>
                    <td>{{ thoracic_data.forward_head_posture }} cm</td>
                    <td class="gold-standard">0-3 cm</td>
                    <td>{{ thoracic_data.fhp_percentage }}%</td>
                    <td class="{% if thoracic_data.forward_head_posture > 3 %}value-poor{% else %}value-good{% endif %}">
                        {% if thoracic_data.forward_head_posture > 3 %}Excessive{% else %}Normal{% endif %}
                    </td>
                </tr>
            </table>
        </div>
        {% endif %}
    </div>
</div>

<div class="section-divider"></div>

<!-- Posture Assessment Section -->
{% if posture_assessment %}
<div class="assessment-section">
    <h2>Posture Assessment</h2>
    <div class="posture-section">
        {{ posture_assessment|safe }}
    </div>
</div>
<div class="section-divider"></div>
{% endif %}

<!-- Individual Assessment Sections -->
{% if ankle_assessment or ankle_chart %}
<div class="assessment-section">
    <h2>Ankle Assessment</h2>
    <div class="graph-text text-right">
        <div class="text-content">
            {% if ankle_assessment %}
                {{ ankle_assessment|safe }}
            {% else %}
                <p><strong>Ankle Assessment:</strong> Assessment text is being generated...</p>
            {% endif %}
        </div>
        {% if ankle_chart %}
            <img src="{{ ankle_chart }}" alt="Ankle Radar Chart">
        {% else %}
            <div style="width: 800px; height: 800px; display: flex; align-items: center; justify-content: center; border: 2px dashed #ccc; background: #f9f9f9;">
                <p style="color: #666;">Ankle radar chart is being generated...</p>
            </div>
        {% endif %}
    </div>
</div>
<div class="section-divider"></div>
{% endif %}

{% if knee_assessment or knee_chart %}
<div class="assessment-section">
    <h2>Knee Assessment</h2>
    <div class="graph-text text-left">
        <div class="text-content">
            {% if knee_assessment %}
                {{ knee_assessment|safe }}
            {% else %}
                <p><strong>Knee Assessment:</strong> Assessment text is being generated...</p>
            {% endif %}
        </div>
        {% if knee_chart %}
            <img src="{{ knee_chart }}" alt="Knee Radar Chart">
        {% else %}
            <div style="width: 800px; height: 800px; display: flex; align-items: center; justify-content: center; border: 2px dashed #ccc; background: #f9f9f9;">
                <p style="color: #666;">Knee radar chart is being generated...</p>
            </div>
        {% endif %}
    </div>
</div>
<div class="section-divider"></div>
{% endif %}

{% if hip_assessment or hip_chart %}
<div class="assessment-section">
    <h2>Hip Assessment</h2>
    <div class="graph-text text-right">
        <div class="text-content">
            {% if hip_assessment %}
                {{ hip_assessment|safe }}
            {% else %}
                <p><strong>Hip Assessment:</strong> Assessment text is being generated...</p>
            {% endif %}
        </div>
        {% if hip_chart %}
            <img src="{{ hip_chart }}" alt="Hip Radar Chart">
        {% else %}
            <div style="width: 800px; height: 800px; display: flex; align-items: center; justify-content: center; border: 2px dashed #ccc; background: #f9f9f9;">
                <p style="color: #666;">Hip radar chart is being generated...</p>
            </div>
        {% endif %}
    </div>
</div>
<div class="section-divider"></div>
{% endif %}

{% if shoulder_assessment or shoulder_chart %}
<div class="assessment-section">
    <h2>Shoulder Assessment</h2>
    <div class="graph-text text-left">
        <div class="text-content">
            {% if shoulder_assessment %}
                {{ shoulder_assessment|safe }}
            {% else %}
                <p><strong>Shoulder Assessment:</strong> Assessment text is being generated...</p>
            {% endif %}
        </div>
        {% if shoulder_chart %}
            <img src="{{ shoulder_chart }}" alt="Shoulder Radar Chart">
        {% else %}
            <div style="width: 800px; height: 800px; display: flex; align-items: center; justify-content: center; border: 2px dashed #ccc; background: #f9f9f9;">
                <p style="color: #666;">Shoulder radar chart is being generated...</p>
            </div>
        {% endif %}
    </div>
</div>
{% endif %}

<p class="note">
    <strong>Note:</strong> All values are normalized to the patient's body weight and compared to gold-standard ranges. 
    Range measurements are in degrees, force measurements are relative to body weight. 
    "Unavailable data" indicates measurements that could not be obtained during the assessment.
    Asymmetry percentages: <span class="asymmetry-low">Green (0-10%)</span>, 
    <span class="asymmetry-moderate">Yellow (11-20%)</span>, 
    <span class="asymmetry-high">Red (>20%)</span>
</p>

</body>
</html>